<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheets Integration with Filter</title>
</head>
<body>

<label for="filterInput">Filtra per testo:</label>
<input type="text" id="filterInput" oninput="filterTable()" placeholder="Inserisci testo...">

<table id="myTable">
  <thead>
    <tr>
      <th>Colonna 1</th>
      <th>Colonna 2</th>
      <!-- Aggiungi ulteriori colonne se necessario -->
    </tr>
  </thead>
  <tbody>
    <!-- I dati verranno inseriti qui dinamicamente -->
  </tbody>
</table>

<script src="https://apis.google.com/js/api.js"></script>
<script>
  let allData = [];

  function loadGoogleSheet() {
    const credentials = {
      apiKey: ' AIzaSyBwtQ2A0fyHiygMA-cVaT_kpMQHLVygbmQ',
      // Inserisci le tue credenziali qui
    };

    gapi.load('client', () => {
      gapi.client.init({
        apiKey: credentials.apiKey,
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
      }).then(() => {
        const spreadsheetId = '1Z7WnliBu1uSRiE5f1r41cdMt4Y-yzoZExpeNtwItMzU';
        const range = 'RISPOSTE!B1:C30';

        return gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId,
          range,
        });
      }).then((response) => {
        const values = response.result.values;
        allData = values;
        populateTable(allData);
      }, (error) => {
        console.error('Errore durante la lettura dei dati:', error.result.error.message);
      });
    });
  }

  function filterTable() {
    const filterValue = document.getElementById('filterInput').value.toLowerCase();
    const filteredData = allData.filter(row => {
      return row.some(cell => cell.toLowerCase().includes(filterValue));
    });
    populateTable(filteredData);
  }

  function populateTable(data) {
    const table = document.getElementById('myTable');

    while (table.rows.length > 1) {
      table.deleteRow(1);
    }

    data.forEach(row => {
      const newRow = table.insertRow();
      row.forEach(cell => {
        const newCell = newRow.insertCell();
        newCell.appendChild(document.createTextNode(cell));
      });
    });
  }

  gapi.load('client:auth2', loadGoogleSheet);
</script>

</body>
</html>
